@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
    :root {
        /* ═══════════════════════════════════════════════════════════════════
           LINEAR / NOTION INSPIRED - Dark-first Design System
           Cool neutrals with electric accents, graphs-inspired aesthetic
           ═══════════════════════════════════════════════════════════════════ */

        /* Core backgrounds - dark space palette */
        --background: 220 20% 5%;         /* #0c0f16 - deep space */
        --surface: 220 18% 9%;            /* #121826 - card surfaces */
        --surface-elevated: 220 16% 13%;  /* #1a2233 - hover/active */

        /* Text colors */
        --foreground: 210 30% 94%;        /* #e6edf5 - primary text */
        --foreground-muted: 215 15% 60%;  /* #8b99ad - secondary text */

        /* Card/Popover */
        --card: 220 18% 9%;
        --card-foreground: 210 30% 94%;
        --popover: 220 18% 9%;
        --popover-foreground: 210 30% 94%;

        /* Primary - Electric Cyan */
        --primary: 190 90% 55%;           /* #4ad1ff - electric cyan */
        --primary-foreground: 220 20% 5%;

        /* Secondary - Subtle */
        --secondary: 220 15% 15%;
        --secondary-foreground: 210 20% 80%;

        /* Muted */
        --muted: 220 15% 15%;
        --muted-foreground: 215 15% 50%;

        /* Accent - Electric Cyan (same as primary for consistency) */
        --accent: 190 90% 55%;            /* #4ad1ff */
        --accent-foreground: 220 20% 5%;
        --accent-secondary: 260 80% 65%;  /* #7c5cff - violet */

        /* Destructive */
        --destructive: 0 70% 60%;         /* #ff6b6b - coral */
        --destructive-foreground: 0 0% 100%;

        /* Borders */
        --border: 220 15% 18%;            /* #1f2a3a - subtle */
        --border-strong: 220 15% 25%;     /* #2d3a4d - emphasized */
        --input: 220 15% 18%;
        --ring: 190 90% 55%;
        --radius: 0.5rem;

        /* State colors - Linear-inspired */
        --state-success: 160 70% 55%;     /* #7df7c3 - mint */
        --state-warning: 42 90% 60%;      /* #f6c344 - amber */
        --state-error: 0 70% 60%;         /* #ff6b6b - coral */
        --state-info: 190 90% 55%;        /* #4ad1ff - cyan */

        /* Chart colors - for graphs/sparklines */
        --chart-1: 190 90% 55%;           /* Cyan */
        --chart-2: 260 80% 65%;           /* Violet */
        --chart-3: 160 70% 55%;           /* Mint */
        --chart-4: 42 90% 60%;            /* Amber */
        --chart-5: 0 70% 60%;             /* Coral */
    }

    /* Light mode (optional - keeping dark as default) */
    .light {
        color-scheme: light;

        --background: 220 15% 97%;
        --surface: 220 15% 100%;
        --surface-elevated: 220 15% 95%;

        --foreground: 220 20% 10%;
        --foreground-muted: 215 15% 45%;

        --card: 220 15% 100%;
        --card-foreground: 220 20% 10%;
        --popover: 220 15% 100%;
        --popover-foreground: 220 20% 10%;

        --primary: 190 85% 40%;
        --primary-foreground: 0 0% 100%;

        --secondary: 220 15% 92%;
        --secondary-foreground: 220 15% 30%;

        --muted: 220 15% 92%;
        --muted-foreground: 215 15% 45%;

        --accent: 190 85% 40%;
        --accent-foreground: 0 0% 100%;
        --accent-secondary: 260 70% 55%;

        --destructive: 0 65% 50%;
        --destructive-foreground: 0 0% 100%;

        --border: 220 15% 88%;
        --border-strong: 220 15% 78%;
        --input: 220 15% 88%;
        --ring: 190 85% 40%;

        --state-success: 160 60% 40%;
        --state-warning: 42 80% 45%;
        --state-error: 0 65% 50%;
        --state-info: 190 85% 40%;

        --chart-1: 190 85% 40%;
        --chart-2: 260 70% 55%;
        --chart-3: 160 60% 40%;
        --chart-4: 42 80% 45%;
        --chart-5: 0 65% 50%;
    }
}

@layer base {
    /* Mobile-first box sizing and overflow prevention */
    *,
    *::before,
    *::after {
        @apply border-border;
        box-sizing: border-box;
    }

    /* Prevent horizontal scrolling and ensure safe mobile viewport */
    html {
        overflow-x: hidden;
        /* Prevent zoom on iOS when focusing inputs */
        -webkit-text-size-adjust: 100%;
        text-size-adjust: 100%;
    }

    body {
        @apply bg-background text-foreground;
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        font-size: 16px; /* Slightly smaller for Linear aesthetic */
        line-height: 1.5;
        overflow-x: hidden;
        margin: 0;
        padding: 0;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    /* Prevent content from extending beyond viewport width */
    #root {
        min-height: 100vh;
        min-height: 100dvh; /* Dynamic viewport height for mobile */
        overflow-x: hidden;
        width: 100%;
        max-width: 100vw;
    }

    /* Smooth transitions for all interactive elements */
    button, a {
        transition: all 0.3s ease;
    }

    /* Touch targets minimum 44px per PRD */
    button {
        min-height: 44px;
        min-width: 44px;
    }

    /* Ensure text doesn't overflow containers */
    h1, h2, h3, h4, h5, h6, p, span, div {
        word-wrap: break-word;
        overflow-wrap: break-word;
        hyphens: auto;
        max-width: 100%;
    }

    /* Responsive images and media */
    img, video, iframe {
        max-width: 100%;
        height: auto;
    }

    /* Prevent horizontal scroll from inputs */
    input, textarea, select {
        max-width: 100%;
        box-sizing: border-box;
    }

    /* iOS-specific fixes */
    @supports (-webkit-touch-callout: none) {
        /* Prevent zoom on double-tap for iOS */
        button, input, select, textarea {
            touch-action: manipulation;
        }

        /* Fix iOS viewport height issues */
        body {
            min-height: -webkit-fill-available;
        }
    }
}

@layer utilities {
    /* Mobile-safe utilities for overflow prevention */
    .mobile-safe {
        max-width: 100%;
        overflow-x: hidden;
        box-sizing: border-box;
        word-wrap: break-word;
        overflow-wrap: break-word;
    }

    .mobile-container {
        width: 100%;
        max-width: calc(100vw - 2rem);
        margin-left: auto;
        margin-right: auto;
        padding-left: 1rem;
        padding-right: 1rem;
        box-sizing: border-box;
    }

    .mobile-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: 1rem;
        width: 100%;
        overflow-x: hidden;
    }

    @media (min-width: 480px) {
        .mobile-grid {
            grid-template-columns: repeat(2, 1fr);
        }
    }

    @media (min-width: 768px) {
        .mobile-grid {
            grid-template-columns: repeat(3, 1fr);
        }
    }

    .mobile-card {
        width: 100%;
        max-width: 100%;
        box-sizing: border-box;
        overflow: hidden;
    }

    .mobile-text {
        max-width: 100%;
        word-wrap: break-word;
        overflow-wrap: break-word;
        hyphens: auto;
    }

    .mobile-button {
        width: 100%;
        min-height: 44px;
        touch-action: manipulation;
        user-select: none;
    }

    /* Viewport-aware dimensions */
    .w-safe {
        width: calc(100vw - 2rem);
    }

    .w-safe-sm {
        width: calc(100vw - 1rem);
    }

    .max-w-safe {
        max-width: calc(100vw - 2rem);
    }

    .max-w-safe-sm {
        max-width: calc(100vw - 1rem);
    }

    /* Touch-friendly spacing */
    .touch-spacing {
        padding: 0.75rem;
        min-height: 44px;
        min-width: 44px;
    }

    /* Prevent zoom on iOS inputs */
    .no-zoom {
        font-size: 16px !important;
        transform-origin: left top;
    }

    /* Safe area support */
    .pt-safe {
        padding-top: env(safe-area-inset-top);
    }

    .pb-safe {
        padding-bottom: env(safe-area-inset-bottom);
    }

    .pl-safe {
        padding-left: env(safe-area-inset-left);
    }

    .pr-safe {
        padding-right: env(safe-area-inset-right);
    }

    .p-safe {
        padding-top: env(safe-area-inset-top);
        padding-bottom: env(safe-area-inset-bottom);
        padding-left: env(safe-area-inset-left);
        padding-right: env(safe-area-inset-right);
    }

    /* Responsive text sizes that prevent overflow */
    .text-responsive-sm {
        font-size: clamp(0.875rem, 2.5vw, 1rem);
    }

    .text-responsive-base {
        font-size: clamp(1rem, 3vw, 1.125rem);
    }

    .text-responsive-lg {
        font-size: clamp(1.125rem, 4vw, 1.5rem);
    }

    .text-responsive-xl {
        font-size: clamp(1.25rem, 5vw, 2rem);
    }

    /* Hide scrollbar for horizontal scrolling sections */
    .scrollbar-hide {
        -ms-overflow-style: none;  /* IE and Edge */
        scrollbar-width: none;  /* Firefox */
    }

    .scrollbar-hide::-webkit-scrollbar {
        display: none;  /* Chrome, Safari and Opera */
    }

    /* Debug utilities for mobile testing */
    .debug-viewport {
        position: relative;
    }

    .debug-viewport::after {
        content: "Mobile: " attr(data-width) "px";
        position: fixed;
        top: 0;
        right: 0;
        background: red;
        color: white;
        padding: 0.25rem;
        font-size: 12px;
        z-index: 9999;
    }

    @media (min-width: 480px) {
        .debug-viewport::after {
            content: "Tablet: " attr(data-width) "px";
            background: orange;
        }
    }

    @media (min-width: 768px) {
        .debug-viewport::after {
            content: "Desktop: " attr(data-width) "px";
            background: green;
        }
    }

    /* Accessibility utilities for WCAG 2.1 AA compliance */

    /* Screen reader only - visually hidden but accessible to screen readers */
    .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
    }

    /* Skip to content link - hidden until focused */
    .skip-link {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border-width: 0;
    }

    .skip-link:focus,
    .skip-link:focus-visible {
        position: absolute !important;
        top: 0 !important;
        left: 0 !important;
        width: auto !important;
        height: auto !important;
        padding: 0.75rem 1.5rem !important;
        margin: 0 !important;
        overflow: visible !important;
        clip: auto !important;
        white-space: normal !important;
        z-index: 100 !important;
        background-color: hsl(var(--primary)) !important;
        color: hsl(var(--primary-foreground)) !important;
        font-size: 1rem !important;
        font-weight: 600 !important;
        text-decoration: none !important;
        border-radius: 0 0 0.5rem 0 !important;
        box-shadow: 0 0 0 4px hsl(var(--accent) / 0.1), 0 4px 6px -1px rgb(0 0 0 / 0.1) !important;
        outline: 3px solid hsl(var(--accent)) !important;
        outline-offset: 2px !important;
    }

    /* Focus indicators for WCAG 2.1 AA compliance */

    /* Remove default outline and use modern focus-visible */
    *:focus {
        outline: none;
    }

    /* Visible focus indicators for keyboard navigation */
    *:focus-visible {
        outline: 3px solid hsl(var(--accent));
        outline-offset: 2px;
        transition: outline 0.2s ease;
    }

    /* Button focus states */
    button:focus-visible,
    a:focus-visible {
        outline: 3px solid hsl(var(--accent));
        outline-offset: 2px;
        box-shadow: 0 0 0 4px hsl(var(--accent) / 0.1);
    }

    /* Input focus states - more prominent for form fields */
    input:focus-visible,
    textarea:focus-visible,
    select:focus-visible {
        outline: 3px solid hsl(var(--accent));
        outline-offset: 2px;
        border-color: hsl(var(--accent));
        box-shadow: 0 0 0 4px hsl(var(--accent) / 0.1);
    }

    /* Card/interactive element focus states */
    [role="button"]:focus-visible,
    [tabindex="0"]:focus-visible {
        outline: 3px solid hsl(var(--accent));
        outline-offset: 2px;
        box-shadow: 0 0 0 4px hsl(var(--accent) / 0.1);
    }

    /* Modal/dialog focus - subtle inner ring */
    [role="dialog"]:focus-visible,
    [role="alertdialog"]:focus-visible {
        outline: 2px solid hsl(var(--ring));
        outline-offset: -2px;
    }

    /* Checkbox and radio focus states */
    input[type="checkbox"]:focus-visible,
    input[type="radio"]:focus-visible {
        outline: 3px solid hsl(var(--accent));
        outline-offset: 2px;
        box-shadow: 0 0 0 4px hsl(var(--accent) / 0.2);
    }

    /* Dark mode focus indicators - slightly brighter */
    .dark *:focus-visible {
        outline-color: hsl(var(--accent));
        box-shadow: 0 0 0 4px hsl(var(--accent) / 0.15);
    }

    /* High contrast mode support */
    @media (prefers-contrast: high) {
        *:focus-visible {
            outline-width: 4px;
            outline-offset: 3px;
        }
    }

    /* Reduce motion for users who prefer it */
    @media (prefers-reduced-motion: reduce) {
        *:focus-visible {
            transition: none;
        }
    }

    /* RTL (Right-to-Left) Support for Hebrew */

    /* Base RTL direction */
    [dir="rtl"] {
        direction: rtl;
    }

    [dir="ltr"] {
        direction: ltr;
    }

    /* RTL-aware spacing utilities - reverse space-x in RTL */
    [dir="rtl"] .space-x-reverse > :not([hidden]) ~ :not([hidden]) {
        --tw-space-x-reverse: 1;
    }

    /* Flip directional icons in RTL */
    [dir="rtl"] .rtl-flip {
        transform: scaleX(-1);
    }

    /* Logical properties for auto-flip margins/padding in RTL */
    .ms-auto {
        margin-inline-start: auto;
    }

    .me-auto {
        margin-inline-end: auto;
    }

    .ps-4 {
        padding-inline-start: 1rem;
    }

    .pe-4 {
        padding-inline-end: 1rem;
    }

    /* RTL-aware flex direction */
    [dir="rtl"] .flex-row {
        flex-direction: row-reverse;
    }

    /* RTL-aware text alignment */
    [dir="rtl"] .text-left {
        text-align: right;
    }

    [dir="rtl"] .text-right {
        text-align: left;
    }

    /* ═══ LINEAR / NOTION DESIGN SYSTEM ═══ */

    /* Grid pattern overlay - graphs aesthetic */
    .bg-grid-pattern {
        background-image:
            linear-gradient(hsl(var(--border) / 0.3) 1px, transparent 1px),
            linear-gradient(90deg, hsl(var(--border) / 0.3) 1px, transparent 1px);
        background-size: 24px 24px;
    }

    /* Finer grid for cards */
    .bg-grid-pattern-fine {
        background-image:
            linear-gradient(hsl(var(--border) / 0.2) 1px, transparent 1px),
            linear-gradient(90deg, hsl(var(--border) / 0.2) 1px, transparent 1px);
        background-size: 16px 16px;
    }

    /* Dot pattern (alternative) */
    .bg-dot-pattern {
        background-image: radial-gradient(circle, hsl(var(--border) / 0.4) 1px, transparent 1px);
        background-size: 20px 20px;
    }

    /* Subtle glow gradient for hero sections */
    .bg-glow-gradient {
        background-image:
            radial-gradient(ellipse 60% 40% at 50% 0%, hsl(var(--accent) / 0.15), transparent);
    }

    /* Surface gradient for cards */
    .bg-surface-gradient {
        background: linear-gradient(
            135deg,
            hsl(var(--surface)) 0%,
            hsl(var(--surface-elevated) / 0.5) 100%
        );
    }

    /* Skeleton shimmer gradient */
    .bg-shimmer {
        background: linear-gradient(
            90deg,
            hsl(var(--muted)) 25%,
            hsl(var(--surface-elevated)) 50%,
            hsl(var(--muted)) 75%
        );
        background-size: 200% 100%;
        animation: shimmer 1.5s ease-in-out infinite;
    }

    @keyframes shimmer {
        0% { background-position: -200% 0; }
        100% { background-position: 200% 0; }
    }

    /* Frosted glass navigation */
    .frosted-nav {
        background: hsl(var(--background) / 0.85);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-top: 1px solid hsl(var(--border));
    }

    /* Glass card effect */
    .glass-card {
        background: hsl(var(--surface) / 0.8);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid hsl(var(--border));
    }

    /* Gradient border effect */
    .gradient-border {
        position: relative;
        background: hsl(var(--surface));
        border-radius: 0.5rem;
    }

    .gradient-border::before {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: inherit;
        padding: 1px;
        background: linear-gradient(
            135deg,
            hsl(var(--accent)),
            hsl(var(--accent-secondary))
        );
        -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
        mask-composite: exclude;
    }

    /* Gradient text */
    .text-gradient {
        background: linear-gradient(
            135deg,
            hsl(var(--accent)),
            hsl(var(--accent-secondary))
        );
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
    }

    /* Accent glow */
    .glow-accent {
        box-shadow: 0 0 20px -5px hsl(var(--accent) / 0.5);
    }

    /* Section header style - Linear/Notion aesthetic */
    .section-header {
        font-family: 'IBM Plex Mono', 'SF Mono', monospace;
        font-size: 11px;
        font-weight: 500;
        letter-spacing: 0.05em;
        text-transform: uppercase;
        color: hsl(var(--muted-foreground));
    }

    /* Micro label style */
    .micro-label {
        font-family: 'IBM Plex Mono', 'SF Mono', monospace;
        font-size: 10px;
        font-weight: 500;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: hsl(var(--muted-foreground));
    }

    /* Delta badge styles */
    .delta-up {
        color: hsl(var(--state-success));
    }

    .delta-down {
        color: hsl(var(--state-error));
    }

    /* Thin divider */
    .divider {
        height: 1px;
        background: hsl(var(--border));
        width: 100%;
    }

    /* Panel hover effect */
    .panel-hover {
        transition: background-color 150ms ease, border-color 150ms ease;
    }

    .panel-hover:hover {
        background-color: hsl(var(--surface-elevated));
        border-color: hsl(var(--border-strong));
    }
}

